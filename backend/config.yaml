# CF-AI-SDE System Configuration
# Central configuration for all modules

# System-wide settings
system:
  name: "CF-AI-SDE"
  version: "1.0.0"
  environment: "development"  # development, staging, production
  log_level: "INFO"

# Data ingestion settings
data_ingestion:
  source: "yahoo"
  symbols: ["AAPL", "MSFT", "GOOGL", "^GSPC", "^NSEI"]
  default_timeframe: "1d"
  lookback_days: 365
  validation:
    enabled: true
    max_missing_pct: 0.05
    price_outlier_threshold: 3.0
    volume_outlier_threshold: 5.0

# Feature engineering settings
feature_engineering:
  indicators:
    trend: ["sma", "ema", "macd", "adx"]
    momentum: ["rsi", "stochastic", "roc", "williams_r", "cci", "mfi"]
    volatility: ["atr", "bollinger_bands", "keltner_channels"]
    volume: ["obv", "vwap", "cmf", "vroc"]
  normalization:
    method: "robust"  # robust, standard, minmax
    outlier_clip: 3.0
  feature_selection:
    enabled: false
    method: "mutual_info"
    top_k: 50

# ML Models settings
ml_models:
  direction:
    default_model: "xgboost"
    models:
      xgboost:
        n_estimators: 200
        max_depth: 6
        learning_rate: 0.01
      lstm:
        units: [128, 64]
        dropout: 0.2
        epochs: 50
        batch_size: 32
  volatility:
    default_model: "garch"
    models:
      garch:
        p: 1
        q: 1
      lstm:
        lookback: 60
        horizon: 5
        units: [128, 64]
  regime:
    default_model: "random_forest"
    regimes: ["TRENDING_UP", "TRENDING_DOWN", "RANGING", "VOLATILE", "CRISIS"]
    window_size: 60
  persistence:
    enabled: true
    storage: "mongodb"  # mongodb, filesystem
    versioning: true

# AI Agents settings
ai_agents:
  enabled_agents: ["market_data", "risk_monitoring", "sentiment", "volatility", "regime", "signal_aggregator"]
  parallel_execution: true
  timeout_seconds: 30
  
  market_data_agent:
    gap_threshold: 0.02
    volume_spike_threshold: 2.0
    volatility_outlier_threshold: 2.0
  
  risk_monitoring_agent:
    var_limit: 0.05
    drawdown_limit: 0.10
    position_limit: 0.20
  
  sentiment_agent:
    model: "ProsusAI/finbert"
    news_api_enabled: true
    max_articles: 20
  
  volatility_agent:
    model: "garch"
    forecast_horizon: 5
  
  regime_detection_agent:
    model: "lstm"
    confidence_threshold: 0.7
  
  signal_aggregator_agent:
    llm_provider: "gemini"  # gemini, groq
    fallback_provider: "groq"
    conflict_resolution: "weighted_voting"
    dynamic_weighting: true

# Strategy settings
strategies:
  default_strategy: "ml_enhanced"
  available_strategies: ["rsi", "ma_cross", "bollinger_band", "ml_enhanced", "options"]
  
  rsi:
    oversold: 30
    overbought: 70
    period: 14
  
  ma_cross:
    fast_period: 50
    slow_period: 200
  
  ml_enhanced:
    confidence_threshold: 0.6
    use_agents: true
    dynamic_position_sizing: true
  
  orchestration:
    enabled: true
    llm_provider: "gemini"
    regime_based_selection: true

# Risk management settings
risk_management:
  max_position_size: 0.20  # 20% of portfolio
  max_sector_concentration: 0.40  # 40% per sector
  max_drawdown: 0.15  # 15% circuit breaker
  var_confidence: 0.95
  stop_loss_pct: 0.05  # 5%
  take_profit_pct: 0.10  # 10%

# Backtesting settings
backtesting:
  engine: "quant_strategy"  # quant_strategy, backtesting_risk
  initial_capital: 100000
  slippage_pct: 0.001  # 0.1%
  commission_pct: 0.001  # 0.1%
  exchange_fee_pct: 0.0001  # 0.01%
  
  advanced:  # Backtesting_risk specific
    walk_forward:
      enabled: false
      train_window: 252  # 1 year
      test_window: 63  # 3 months
    metrics:
      include_shap: true
      export_format: ["csv", "json"]

# RAG Mentor settings
rag_mentor:
  enabled: true
  vector_db: "chromadb"
  chromadb_path: "./RAG_Mentor/chroma_db"
  embedding_model: "sentence-transformers/all-MiniLM-L6-v2"
  top_k_results: 5
  llm_provider: "gemini"
  fallback_provider: "groq"
  
  violation_detection:
    averaging_down: true
    missing_stop_loss: true
    overtrading: true
    position_sizing: true
  
  improvement_engine:
    max_suggestions: 5
    include_code_examples: true

# API Keys (use environment variables)
api_keys:
  gemini: ${GEMINI_API_KEY}
  groq: ${GROQ_API_KEY}
  news_api: ${NEWS_API_KEY}
  economic_calendar: ${ECONOMIC_CALENDAR_API_KEY}
  huggingface: ${HUGGINGFACE_TOKEN}

# Database settings (Phase 2)
database:
  provider: "mongodb"
  uri: ${MONGODB_URI}
  database_name: ${MONGODB_DATABASE}
  graceful_fallback: true
  fallback_storage: "./data/fallback"
  
  collections:
    market_data_raw: "market_data_raw"
    market_data_clean: "market_data_clean"
    market_features: "market_features"
    agent_outputs: "agent_outputs"
    agent_memory: "agent_memory"
    ml_models: "ml_models"
    portfolio_positions: "portfolio_positions"
    audit_log: "audit_log"
    validation_logs: "validation_logs"
  
  indexing:
    enabled: true
    collections_to_index: "all"
  
  connection_pool:
    min_size: 10
    max_size: 100
    max_idle_time_ms: 60000
